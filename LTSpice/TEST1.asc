Version 4
SHEET 1 2824 1072
WIRE 80 -144 16 -144
WIRE 208 -144 160 -144
WIRE 336 -144 208 -144
WIRE 576 -144 336 -144
WIRE 656 -144 576 -144
WIRE 784 -144 720 -144
WIRE 800 -144 784 -144
WIRE 896 -144 864 -144
WIRE 1360 -144 1024 -144
WIRE 1360 -128 1360 -144
WIRE 208 -16 208 -144
WIRE 576 -16 576 -144
WIRE 1360 0 1360 -48
WIRE 1456 0 1360 0
WIRE 1456 16 1456 0
WIRE 336 48 336 -144
WIRE 416 48 336 48
WIRE 784 48 784 -144
WIRE 784 48 736 48
WIRE 1024 64 1024 -144
WIRE 336 96 336 48
WIRE 1360 96 1360 80
WIRE 1456 96 1456 80
WIRE 1456 96 1360 96
WIRE 1360 128 1360 96
WIRE 416 144 48 144
WIRE 864 144 736 144
WIRE 976 144 944 144
WIRE 336 240 336 176
WIRE 416 240 336 240
WIRE 896 240 896 -144
WIRE 896 240 736 240
WIRE 1024 240 1024 160
WIRE 1024 240 896 240
WIRE 1104 240 1024 240
WIRE 1232 240 1184 240
WIRE 1360 240 1360 192
WIRE 1360 240 1312 240
WIRE 1024 256 1024 240
WIRE 1360 272 1360 240
WIRE 48 336 48 144
WIRE 112 336 48 336
WIRE 272 336 176 336
WIRE 416 336 272 336
WIRE 864 336 736 336
WIRE 976 336 944 336
WIRE 112 368 112 352
WIRE 1360 400 1360 352
WIRE 1456 400 1360 400
WIRE 1456 416 1456 400
WIRE 208 432 208 48
WIRE 256 432 208 432
WIRE 416 432 336 432
WIRE 832 432 736 432
WIRE 1024 432 1024 352
WIRE 1024 432 832 432
WIRE 1360 496 1360 480
WIRE 1456 496 1456 480
WIRE 1456 496 1360 496
WIRE 208 512 208 432
WIRE 352 512 208 512
WIRE 576 512 576 496
WIRE 576 512 352 512
WIRE 832 512 832 432
WIRE 832 512 576 512
WIRE 352 528 352 512
WIRE 1360 528 1360 496
WIRE 1024 608 1024 432
WIRE 1360 608 1360 592
WIRE 1360 608 1024 608
WIRE 144 800 144 752
WIRE 608 800 608 752
WIRE 608 800 144 800
WIRE 144 832 144 800
FLAG 352 528 0
FLAG 48 416 0
FLAG 112 368 0
FLAG 272 336 vinv
FLAG 144 832 0
FLAG 144 672 Vcarr
FLAG 608 672 Vref
FLAG 16 -144 0
FLAG 1024 608 0
SYMBOL PowerProducts\\LTC7061 576 240 R0
SYMATTR InstName U1
SYMBOL cap 192 -16 R0
SYMATTR InstName C1
SYMATTR Value 0.22µ
SYMBOL res 352 192 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value 51k
SYMBOL res 352 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 250k
SYMBOL cap 800 -128 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL schottky 656 -128 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value MBR20100CT
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 176 -144 R90
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 10
SYMBOL ind 1216 256 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 50µ
SYMBOL Digital\\inv 112 272 R0
WINDOW 39 107 94 Left 2
SYMATTR SpiceLine Vhigh=5 Vlow=0 Vt=2.5
SYMATTR InstName A1
SYMBOL bv 48 320 R0
WINDOW 3 2 -39 Left 2
SYMATTR Value V=if(V(Vref)>V(Vcarr),5,0)
SYMATTR InstName B1
SYMBOL voltage 144 656 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 1 0 5u 5u 0 10u)
SYMBOL voltage 608 656 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value SINE(0.5 0.05 {fsig})
SYMBOL Misc\\cell 1360 128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 84 Left 2
SYMATTR InstName cell1
SYMATTR Value 4
SYMBOL Misc\\cell 1360 528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 84 Left 2
SYMATTR InstName cell2
SYMATTR Value 4
SYMBOL res 1200 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 22m
SYMBOL res 1344 -144 R0
SYMATTR InstName R10
SYMATTR Value {Rsol}
SYMBOL res 1344 256 R0
SYMATTR InstName R11
SYMATTR Value {Rsol}
SYMBOL res 1344 -16 R0
SYMATTR InstName R1
SYMATTR Value {R}
SYMBOL cap 1440 16 R0
SYMATTR InstName C2
SYMATTR Value {C}
SYMBOL res 1344 384 R0
SYMATTR InstName R7
SYMATTR Value {R}
SYMBOL cap 1440 416 R0
SYMATTR InstName C4
SYMATTR Value {C}
SYMBOL TW107N65C_G0_00_LTspice_rev1_enc 976 64 R0
WINDOW 3 56 72 Invisible 2
SYMATTR InstName U2
SYMBOL TW107N65C_G0_00_LTspice_rev1_enc 976 256 R0
WINDOW 3 56 72 Invisible 2
SYMATTR InstName U3
SYMBOL res 960 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 20
SYMBOL res 960 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 5
TEXT 904 680 Left 2 !.tran 0 {f(fsig)} {g(fsig)} uic
TEXT 904 760 Left 2 !.func f(fsig) {7/fsig}
TEXT 904 800 Left 2 !.func g(fsig) {5/fsig}
TEXT 904 720 Left 2 !.param fsig=1000 R=1 Rsol=10m C=1m
TEXT 904 840 Left 2 !.ic V(C2)=-7.5m V(C4)=-7.5m V(C3)=10
TEXT 1432 -32 Left 2 ;battery1
TEXT 1424 376 Left 2 ;battery2
TEXT 56 112 Left 2 ;PWM
TEXT 904 880 Left 2 !.save V(N004,N012) or .save I(R10)
RECTANGLE Normal 1520 208 1312 -128 2
RECTANGLE Normal 1520 592 1312 272 2
RECTANGLE Normal 192 448 0 112 2
